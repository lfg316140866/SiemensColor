CmnMis_UI_Control_HasMap_Version = "1.0", function () { var a = CmnMis.UI.Control; a.HasMap = function (a, b) { var c, d; Cmn.Object.Inherit(this, CmnMis.UI.Control.BasControl, [a, b]), c = this, c.Type = "HasMap", c.KeyName = a, c.ControlCfg = c.InitControlConfig(Cmn.Extend(c.ControlCfg, { Format: "KeyVal" }, b)), c.GetInitHtml = function () { return "" }, d = function (a) { var b = a, d = "", e = c.ControlDom.find(CmnMis.UI.Control.Selector.CtlContent), f = 1; e.empty(), b && b.length > 0 ? (Cmn.IsType(b, "string") && (b = $.parseJSON(b)), f = b.length, $.each(b, function (a, e) { var f, g; Cmn.IsType(b, "object") && "Json" == c.ControlCfg.Format ? (f = a, g = e) : (f = e.key, g = e.value), d += "<div class='cmn-Ctl-HasMapItem' style='width:100%;height:25px;line-height:25px;margin-top:5px;'><input type=\"text\"   value=\"" + f + "\" style='width:25%;height:100%;  text-align: center; border:1px solid #e6e6e6;' />" + "<b> -- </b>" + '<input type="text"  value="' + g + "\" style='width:35%;height:100%;  text-align: center; border:1px solid #e6e6e6;' />" + "<button class='cmn-Ctl-HasMapDel' style='width:25%;height:100%;margin-left:5px;  cursor: pointer; border:1px solid #e6e6e6;'>" + "删除</button>" + "</div>" })) : d += "<div class='cmn-Ctl-HasMapItem' style='width:100%;height:25px;line-height:25px;margin-top:5px;'><input type=\"text\" style='width:25%;height:100%;  text-align: center; border:1px solid #e6e6e6;' /><b> -- </b><input type=\"text\" style='width:35%;height:100%;  text-align: center; border:1px solid #e6e6e6;' /><button class='cmn-Ctl-HasMapDel' style='width:25%;height:100%;margin-left:5px;  cursor: pointer; border:1px solid #e6e6e6;'>删除</button></div>", d += "<div style='width:100%;height:33px;line-height:25px;'><button class='cmn-Ctl-HasMapAdd' style='width:25%;height:100%;  margin-top: 10px; cursor: pointer;border:1px solid #e6e6e6;'>添加</button><div>", e.height(40 * f + 33).append($(d)), c.ControlDom.height(e.height()), e.find(".cmn-Ctl-HasMapAdd").off("click").on("click", function () { var a = e.find(".cmn-Ctl-HasMapItem").eq(0).clone(!0, !0); a.find("input").val(""), a.insertBefore($(this)), e.css({ height: "+=40px" }), c.ControlDom.height(e.height()) }), e.undelegate(".cmn-Ctl-HasMapDel", "click").delegate(".cmn-Ctl-HasMapDel", "click", function () { $(this).parent().remove(), e.css({ height: "-=40px" }), c.ControlDom.height(e.height()) }) }, this.InitControl = function () { }, c.GetValue = function () { var a = []; return "Json" == c.ControlCfg.Format && (a = {}), c.ControlDom.find(".cmn-Ctl-HasMapItem").each(function () { var b = $(this).find("input").eq(0).val(), d = $(this).find("input").eq(1).val(); b && d && ("Json" == c.ControlCfg.Format ? a[b] = d : a.push({ key: b, value: d })) }), a }, c.SetValue = function (a) { d(a) } } }();