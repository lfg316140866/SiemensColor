CmnMis_UI_Control_CmnMisRowControl_Version = "2.0", function () { var a = CmnMis.UI.Control; a.BasRowControl = function () { this.Init = function () { }, this.AfterFillData = function () { } }, a.PrintRow = function (b, c, d) { Cmn.Object.Inherit(this, a.BasRowControl, [b, c, d]), this.Init = function (a) { for (var c = 0; c < a.length; c++) a[c][b] = "<a target='_blank' class='cmn-tmp-PrintRow'><img src='Image/print.gif' /></a>" }, this.AfterFillData = function () { $(CmnMis.CurUserForm.GetSelector(".cmn-tmp-PrintRow")).each(function () { var f, a = CmnMis.Func.GetItfUrl(CmnMis.CurUserForm, CmnMis.CurUserForm.Cfg.MethodName.GetRecList), b = CmnMis.CurUserForm.GetRecAjaxParam(), e = "[" + d + "]='" + CmnMis.CurUserForm.GetCurRecKeyVal($(this)) + "'"; b["Condition"] = b["Condition"] ? b["Condition"] + " and " + e : e; for (f in b) a = Cmn.Func.AddParamToUrl(a, f + "=" + encodeURIComponent(b[f])); a = Cmn.Func.AddParamToUrl(CmnAjax.Func.GetProxyUrl(a), "method=GetExcel&FileName=" + c["TemplateFileName"] + (void 0 != c["Sql"] && "" != c["Sql"] ? "&cmn_OutputDataSql=" + encodeURIComponent(c["Sql"]) : "")), $(this).attr("href", a) }) } } }();