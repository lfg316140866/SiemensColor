Cmn_UI_Version = "2.0", function (a, b) { var c = a.Cmn, d = a.CmnAjax; c || alert("为引用Cmn"), c.UI || (c.UI = {}), c.UI.BasPlugin = function (a) { this.Resources = a || [], this.RootPath = c.Func.GetJsPath("Cmn.js"), this.Load() }, c.UI.BasPlugin.prototype.Load = function () { var a, b; if (!(this.Resources.length < 1)) for (d || c.alert("CmnAjax.js 未引用！"), a = 0; a < this.Resources.length; a++) b = this.RootPath + this.Resources[a], d.GetFile && d.GetFile(b, function () { }, !1) }, $.extend(c.UI, { CanTouch: c.Func.IsMobile(), CanHtml5: "undefined" != typeof Worker, KeyCode: { BACKSPACE: 8, COMMA: 188, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, LEFT: 37, NUMPAD_ADD: 107, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, NUMPAD_ENTER: 108, NUMPAD_MULTIPLY: 106, NUMPAD_SUBTRACT: 109, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SPACE: 32, TAB: 9, UP: 38 }, EventType: { Mousedown: c.Func.IsMobile() ? "touchstart" : "mousedown", Mousemove: c.Func.IsMobile() ? "touchmove" : "mousemove", Mouseup: c.Func.IsMobile() ? "touchend" : "mouseup" }, StopBubble: function (b) { b && b.stopPropagation ? b.stopPropagation() : a.event.cancelBubble = !0 }, StopDefault: function (b) { return b && b.preventDefault ? b.preventDefault() : a.event.returnValue = !1, !1 }, GetSelectorName: function (a) { return a.replace(/[\s\S]*([\.]|[\#])/g, "") }, FrameAnimation: function (b, c) { return new function () { var e, f, g, d = this; d.frames = $(b), d.index = 0, d.timer = 0, e = d.frames.length, f = c / e, g = "ASC", _isStop = !0, d.frames.length < 1 || (d.onStop = function () { }, d.Init = function () { a.clearInterval(d.timer), d.frames.eq(d.index).show().siblings().hide(), _isStop = !0 }, d.Play = function () { this.PlayToStop() }, d.Stop = function () { a.clearInterval(d.timer) }, d.PlayToStop = function (b, c) { var i, h = e; b && (h = b), i = h - d.index, i && (g = 0 > i ? "DESC" : "ASC", i = Math.abs(i), c && (f = c / i), a.clearInterval(d.timer), d.timer = a.setInterval(function () { if ("ASC" == g) { if (d.index++, d.index > h) return d.index = h, a.clearInterval(d.timer), void 0 } else if (d.index--, d.index < h) return d.index = h, a.clearInterval(d.timer), void 0; d.frames.eq(d.index).show().siblings().hide() }, f)) }, d.Init()) } }, Drag: function (b, d) { function n(b) { function d(a) { c.UI.StopBubble(a), c.UI.StopDefault(a), k = h.getMousePoint(a); var b = {}, d = !1; return i.left = l.left + k.x - m.x, i.top = l.top + k.y - m.y, i.right = _dragWidth + i.left, i.bottom = i.top + _dragHeight, "x" == f.axis ? b.left = i.left + "px" : "y" == f.axis ? b.top = i.top + "px" : (b.left = i.left + "px", b.top = i.top + "px"), f.containment ? (j.left <= i.left && j.right >= i.right || "y" == f.axis) && (j.top <= i.top && j.bottom >= i.bottom || "x" == f.axis) && (d = !0) : d = !0, d && f.onMove.call(f.drag.css(b), h.getMousePoint(a)), !1 } function n() { $(a).off(c.UI.EventType.Mouseup), $(f.dragParent).off(c.UI.EventType.Mousemove), l = { left: 0, top: 0 }, g = !1, f.onEnd.call(f.drag) } return c.UI.StopBubble(b), c.UI.StopDefault(b), g ? !1 : (g = !0, f.drag = $(this), j = { left: 0, right: $(f.containment).width(), top: 0, bottom: $(f.containment).height() }, i = { left: 0, right: 0, top: 0, bottom: 0 }, _dragWidth = f.drag.width(), _dragHeight = f.drag.height(), f.containment = $(f.containment), m = h.getMousePoint(b), l = f.drag.position(), f.onStart.call(f.drag, h.getMousePoint(b)), $(f.dragParent).off(e.EventType.Mousemove).on(e.EventType.Mousemove, d), $(a).off(e.EventType.Mouseup).on(e.EventType.Mouseup, n), void 0) } var e = this, f = $.extend({ dragParent: $("body"), containment: $("body"), drag: b, axis: "", onStart: function () { }, onMove: function () { }, onEnd: function () { } }, d), g = !1, h = { getMousePoint: function (a) { return a = event.touches ? event.touches[0] : a, { x: a.pageX, y: a.pageY } } }, i = null, j = null, k = { x: 0, y: 0 }, l = { x: 0, y: 0 }, m = { x: 0, y: 0 }; $(f.containment).find(f.drag).css("position", "absolute"), $(f.dragParent).undelegate(f.drag, e.EventType.Mousedown, n).delegate(f.drag, e.EventType.Mousedown, n) }, CustomScroll: function (b, d) { return new function () { var e = this, f = $(b), g = $("<div>").css({ height: "100%", width: "100%", overflow: "hidden", position: "relative" }).html(f.html()).addClass("cmn-scrollContent").appendTo(f.empty()), h = $.extend({ selector: { ScrollBar: ".cmn-ScrollBar", BarBtn: ".cmn-ScrollBarBtn" }, rollStyle: "", dragBarAutoSize: !1, orientation: -1, scrollWidth: g.prop("scrollWidth"), scrollHeight: g.prop("scrollHeight"), onScrollBarDown: function () { }, onScrollBarUp: function () { }, onStart: function () { }, onMove: function () { }, onEnd: function () { } }, d), i = f.find(h.selector.ScrollBar), j = f.find(h.selector.BarBtn), k = i.outerHeight(!0), m = (i.outerWidth(!0), j.outerHeight(!0)), o = (j.outerWidth(!0), f.innerHeight()), q = (f.innerWidth(), 10), r = 0, s = 0, t = 0; return f.length > 1 ? (alert("滚动条容器冲突！请检查！"), void 0) : h.scrollHeight - o <= 0 ? (i.hide(), void 0) : (i.show(), f.append(i), k = o - 2 * parseInt(i.css("top")), i.height(k), h.dragBarAutoSize && (m = k / h.scrollHeight * m, m = 30 > m ? 30 : m, j.height(m)), e.Scrollfn = { roll: function (a) { r = a || r, j.css("top", r), s = (h.scrollHeight - o) / (k - m) * r, Math.abs(t - s) > q / 2 ? g.stop(!0, !1).animate({ scrollTop: s }, 300, h.rollStyle, function () { t = g.scrollTop() }) : g.stop(!0, !1).scrollTop(s), t = s }, MouseDown: function (a) { r = a.y - m / 2, q > k - r - m ? r = k - m : 0 >= r - q && (r = 0), this.roll() } }, i.off(c.UI.EventType.Mousedown).on(c.UI.EventType.Mousedown, function (b) { if (3 != b.which) { b = b || a.event; var d = { y: b.offsetY || b.originalEvent.layerY, x: b.offsetX || b.originalEvent.layerX }; return e.Scrollfn.MouseDown(d), h.onScrollBarDown(b), c.UI.StopBubble(b) } }), i.off(c.UI.EventType.Mouseup).on(c.UI.EventType.Mouseup, function (a) { h.onScrollBarUp(a) }), c.UI.Drag(j, { containment: i, axis: "y", onStart: function () { h.onStart() }, onMove: function () { e.Scrollfn.roll(this.position().top), h.onMove() }, onEnd: function () { h.onEnd() } }), c.UI.CanTouch || (f.hover(function () { i.fadeIn(300) }, function () { i.fadeOut(300) }), f.on("mousewheel DOMMouseScroll", function (a) { var b = a.originalEvent.wheelDelta || -a.originalEvent.detail; return 0 > b ? k - m > r && (q > k - r - m ? r = k - m : r += q) : b > 0 && r > 0 && (0 >= r - q ? r = 0 : r -= q), e.Scrollfn.roll(), c.UI.StopDefault(a), !1 })), void 0) } }, CustomSelect: function (a, b, d) { return new function () { var e = this; e.opt = $.extend({ Selector: {}, OnChange: function () { } }, d), e.Selector = $.extend({ Selector: a, ViewValue: ".cmn-SelectValue", Icon: ".cmn-SelectIcon", IconState: ".cmn-SelectIconShow", OptionContent: ".cmn-SelectOptionContent", OptionList: ".cmn-SelectOptionList", OoptionItem: ".cmn-SelectOptionItem", ScrollBar: ".cmn-ScrollBar", BarBtn: ".cmn-ScrollBarBtn" }, e.opt.Selector), e.SelfDom = $(e.Selector.Selector), e.State = !1, e.HideInput = $("<input type=\"text\" class='cmn-SelectHideInput' />").css({ position: "absolute", top: "-100px", left: "0px" }), e.OptionContentOpen = function () { e.SelfDom.find(e.Selector.Icon).addClass(c.UI.GetSelectorName(e.Selector.IconState)), e.SelfDom.find(e.Selector.OptionContent).stop().show() }, e.OptionContentClose = function () { e.SelfDom.find(e.Selector.Icon).removeClass(c.UI.GetSelectorName(e.Selector.IconState)), e.SelfDom.find(e.Selector.OptionContent).slideUp(50) }, this.SetValueList = function (a) { var b = e.SelfDom.find(e.Selector.OptionList).find(e.Selector.OoptionItem).remove().eq(0), d = e.SelfDom.find(e.Selector.OptionList); $.each(a, function (a, e) { var f = b.clone(!0, !0), g = a, h = e, i = [], j = 0; c.Object.IsType(e, "object") && $.each(e, function (a, b) { 0 == j ? g = b : 1 == j ? h = b : i.push({ name: g, value: h }), j++ }), f.attr("value", g), f.html(h), f.data(i), d.append(f) }) }, this.Init = function (a) { var b, d, f, g; e.SelfDom.find(".cmn-SelectHideInput").size() < 1 && e.SelfDom.append($("<div>").css({ width: "1px", height: "1px", opacity: "0", cursor: "pointer", position: "absolute", top: "0px", left: "0px", overflow: "hidden" }).append(e.HideInput)), a && e.SetValueList(a), b = e.SelfDom.find(e.Selector.OptionContent).css({ opacity: "0", filter: "alpha(opacity=0)" }).show(), d = b.find(e.Selector.OoptionItem), f = d.eq(0).outerHeight(!0) * d.length, b.innerHeight() > f ? b.height(f) : 3 * b.innerHeight() < f, e.SelfDom.find(e.Selector.ScrollBar).length > 0 && c.UI.CustomScroll(b, { onScrollBarDown: function () { e.State = !0 }, onStart: function () { e.State = !0 }, onMove: function () { e.State = !0 }, onScrollBarUp: function () { e.HideInput.focus(), e.State = !1 }, onEnd: function () { e.HideInput.focus(), e.State = !1 } }), b.hide().css({ opacity: "1", filter: "alpha(opacity=100)" }), e.OptionContentClose(), e.SelfDom.off("click").on("click", function () { e.HideInput.focus() }), e.HideInput.off("blur").on("blur", function () { 0 == e.State && e.OptionContentClose() }), e.HideInput.off("focus").on("focus", function () { e.OptionContentOpen() }), e.SelfDom.find(e.Selector.OptionContent).off(c.UI.EventType.Mousedown).on(c.UI.EventType.Mousedown, e.Selector.OoptionItem, function () { e.State = !0 }), e.SelfDom.find(e.Selector.OptionContent).off("click").on("click", e.Selector.OoptionItem, function () { var b, d; c.UI.StopBubble(), b = $(this).text(), d = $(this).attr("value"), e.HideInput.val(d), $(e.Selector.ViewValue).html(b), e.opt.OnChange.call(this, { target: $(this), value: d, text: b }), e.State = !1, e.HideInput.blur() }), g = e.SelfDom.find(e.Selector.OoptionItem).eq(0), $(e.Selector.ViewValue).html(g.text()), e.HideInput.val(g.attr("value")) }, this.Init(c.Object.IsType(b, "array") ? b : {}), this.SetValue = function (a) { var b = e.SelfDom.find(e.Selector.OoptionItem + "[value=" + a + "]").eq(0); b.length > 0 && ($(e.Selector.ViewValue).html(b.text()), e.HideInput.val(a)) }, this.GetValue = function () { return e.HideInput.val() } } }, CustomRadioBox: function (a, b, d) { return new function () { var f, e = this; e.opt = $.extend({ Selector: {}, IsRequired: !0, InputName: "Cg_InputName-" + (new Date).getTime() + "-" + Math.floor(1e3 * Math.random()) }, d), e.Selector = $.extend({ Selector: a, Item: ".cg-Radio-Item", Selected: ".Select", ItemText: ".cg-Radio-ItemText" }, e.opt.Selector), e.SelfDom = $(e.Selector.Selector), f = function (a) { return c.Object.IsType(a, "string") && "true" == a.toLowerCase() ? 1 : c.Object.IsType(a, "string") && "false" == a.toLowerCase() ? 0 : a }, this.SetValueList = function (a) { var b = ""; e.SelfDom.find(e.Selector.Item).length ? (b = e.SelfDom.find(e.Selector.Item).remove().eq(0).removeClass(c.UI.GetSelectorName(e.Selector.Selected)), e.SelfDom.data("item", b)) : b = e.SelfDom.data("item"), b.find("input[type=radio]").length < 1 && b.append($('<input type="radio" name="' + e.opt.InputName + '" />').hide()), $.each(a, function (a, d) { var g = b.clone(!0, !0), h = f(a), i = d, j = [], k = 0; c.Object.IsType(d, "object") && $.each(d, function (a, b) { 0 == k ? h = f(b) : 1 == k ? i = b : j.push({ name: h, value: i }), k++ }), g.attr("value", h), g.find(e.Selector.ItemText).html(i), g.data(j), e.SelfDom.append(g) }) }, this.Init = function (a) { a && e.SetValueList(a), e.SelfDom.find(e.Selector.Item).off("click").on("click", function () { $(this).find("input")[0].checked ? e.opt.IsRequired || ($(this).find("input")[0].checked = !1) : $(this).find("input")[0].checked = !0, e.SelfDom.find("input").change() }), e.SelfDom.find("input").off("change").on("change", function () { $(this)[0].checked ? $(this).parents(e.Selector.Item).eq(0).addClass(c.UI.GetSelectorName(e.Selector.Selected)) : $(this).parents(e.Selector.Item).eq(0).removeClass(c.UI.GetSelectorName(e.Selector.Selected)) }) }, this.Init(c.Object.IsType(b, "array") ? b : {}), this.SetValue = function (a) { if (a) { var b = e.SelfDom.find(e.Selector.Item + "[value=" + f(a) + "]").find("input")[0]; b && (b.checked = !0) } else e.SelfDom.find(e.Selector.Item).find("input").attr("checked", !1); e.SelfDom.find("input").change() }, this.GetValue = function () { return e.SelfDom.find(e.Selector.Selected).attr("value") } } }, CustomAutoComplete: function (b, e, f) { return new function () { function j(a) { i.find(_self.Selector.Item).eq(a).addClass(c.UI.GetSelectorName(_self.Selector.ItemSelect)).siblings(_self.Selector.Item).removeClass(c.UI.GetSelectorName(_self.Selector.ItemSelect)), l(i.find(_self.Selector.ItemSelect).attr(_self.option.value), i.find(_self.Selector.ItemSelect).text()) } function k(a) { return i.empty().hide(), a ? (a.length && a.length > 0 && ($.each(a, function (a, b) { var d, e, f, g; a > _self.option.Limit || (d = i.data("itemTemp").clone(!0, !0), e = d.find(_self.Selector.Text).length > 0 ? d.find(_self.Selector.Text) : d, c.Object.IsType(b, "object") ? (f = 0, g = [], $.each(b, function (a, b) { if (0 == f) d.attr(_self.option.value, b); else if (1 == f) e.text(b); else { var c = {}; c[a] = b, g.push(c) } f++ }), d.data(g)) : (d.attr(_self.option.value, a), e.text(b)), i.append(d)) }), i.show()), void 0) : (i.find(_self.Selector.Item + "[" + _self.option.value + "=" + _self.AutoCompleteInput.attr(_self.option.value) + "]").addClass(c.UI.GetSelectorName(_self.Selector.ItemSelect)).siblings(_self.Selector.Item).removeClass(c.UI.GetSelectorName(_self.Selector.ItemSelect)), i.show(), !1) } function l(a, b) { a !== _self.AutoCompleteInput.attr(_self.option.value, a) && (_self.AutoCompleteInput.val(b).attr(_self.option.value, a), _self.option.Change({ val: a, text: b })) } function m() { i.hide() } function n(a) { switch (a.keyCode) { case c.UI.KeyCode.HOME: break; case c.UI.KeyCode.END: break; case c.UI.KeyCode.UP: c.UI.StopDefault(a); break; case c.UI.KeyCode.DOWN: c.UI.StopDefault(a); break; case c.UI.KeyCode.LEFT: break; case c.UI.KeyCode.RIGHT: break; case c.UI.KeyCode.ENTER: case c.UI.KeyCode.SPACE: break; case c.UI.KeyCode.BACKSPACE: break; case c.UI.KeyCode.ESCAPE: } } function o(a) { var b, d; switch (c.UI.StopBubble(a), c.UI.StopDefault(a), a.keyCode) { case c.UI.KeyCode.HOME: break; case c.UI.KeyCode.END: break; case c.UI.KeyCode.UP: b = i.find(_self.Selector.Item).index($(_self.Selector.ItemSelect)), j(0 >= b ? 0 : --b), c.UI.StopDefault(a); break; case c.UI.KeyCode.DOWN: b = i.find(_self.Selector.Item).index($(_self.Selector.ItemSelect)), d = i.find(_self.Selector.Item).length, 0 > b ? b = 0 : b >= d - 1 ? b = d - 1 : b++, j(b); break; case c.UI.KeyCode.LEFT: break; case c.UI.KeyCode.RIGHT: break; case c.UI.KeyCode.ENTER: _self.AutoCompleteInput.blur(); break; case c.UI.KeyCode.SPACE: p.call(this); break; case c.UI.KeyCode.BACKSPACE: $(this).val() ? p.call(this) : m(); break; case c.UI.KeyCode.ESCAPE: m(); break; default: p.call(this) } } function p() { var a = $(this).val(); /[\S]+/.test((c.Object.IsType(a, "string") ? a : "").trim()) && (_self.DataItf ? d.PostData(_self.DataItf, _self.SerializeParam(a), function (a) { a = _self.onFormatData(a), k(a) }) : k(_self.onFormatData({}))) } _self = this, _self.option = $.extend({ Selector: {}, value: "data-val", SerializeParam: function (a) { return { param: a } }, Limit: 30, FormatData: function (a) { return a && c.Object.IsType(a, "string") && (a = $.parseJSON(a)), a.data && (a = c.Object.IsType(a.data, "string") ? $.parseJSON(a.data) : a.data), a || [] }, Change: function () { }, Click: function () { } }, f), _self.Selector = $.extend({ Selector: b, InputSelector: ".Cg-AutoComplete-Input", OptionList: ".Cg-AutoComplete-OptionList", Item: ".Cg-AutoComplete-Item", Text: ".Cg-AutoComplete-Text", ItemSelect: ".Cg-AutoComplete-ItemHover" }, _self.option.Selector), _self.DataItf = e, _self.SerializeParam = _self.option.SerializeParam, _self.onFormatData = _self.option.FormatData, _self.onChange = _self.option.Change, _self.onClick = _self.option.Click; var g = $(_self.Selector.Selector), h = g.find(_self.Selector.Item).remove().clone(!0, !0).removeClass(c.UI.GetSelectorName(_self.Selector.ItemSelect)), i = g.find(_self.Selector.OptionList); i.data("itemTemp") || i.data("itemTemp", h), _self.AutoCompleteInput = g.find(_self.Selector.InputSelector).val(""), _self.AutoCompleteInput.off("keyup").on("keyup", o), _self.AutoCompleteInput.off("keydown").on("keydown", n), _self.AutoCompleteInput.off("blur").on("blur", function () { m() }), _self.AutoCompleteInput.off("focus").on("focus", function () { $(this).val() && (g.find(_self.Selector.Item).length > 0 ? i.show() : p.call(this)) }), i.undelegate(c.UI.EventType.Mousedown).delegate(_self.Selector.Item, c.UI.EventType.Mousedown, function () { 3 != event.which && (event = event || a.event, l($(this).attr(_self.option.value), $(this).text())) }) } } }), function () { var d = function (d) { function p(a) { var b = h(a), c = { x: b.x - k.x, y: b.y - k.y }; Cmn.Extend(o, c, { Action: "drag" }), (!!c.x || !!c.y) && e.DragEvent.Trigger([o]), (c.x > 10 || c.y > 10) && clearTimeout(n) } function q(b) { var f, g, i, l, m, p; clearTimeout(n), f = h(b), g = Math.abs(f.x - k.x), i = Math.abs(f.y - k.y), l = "", m = 20, p = 50, $(a).off(c.UI.EventType.Mouseup), $(d).off(c.UI.EventType.Mousemove), g > i && 3 * m > i ? (g > m && (l = f.x - k.x <= 0 ? "left" : "right"), "Y" == j && (l = "")) : i > g && 3 * m > g ? (i > m && (l = f.y - k.y <= 0 ? "up" : "down"), "X" == j && (l = "")) : l = "", "" == l ? p > g && p > i ? (o.Action = "tap", Cmn.Extend(o, {})) : o.Action = "" : Cmn.Extend(o, { Action: l }), "tap" == o.Action && e.TapEvent.Trigger([o]), !("" == o.Action || "tap" == o.Action || !e.SwipeEvent.Trigger([o])), (g || i) && (o.Action = "dragend", e.DragEndEvent.Trigger([o])) } var e, h, j, k, n, o; this.TapEvent = new Cmn.Event(d), this.SwipeEvent = new Cmn.Event(d), this.HoldEvent = new Cmn.Event(d), this.DragStartEvent = new Cmn.Event(d), this.DragEvent = new Cmn.Event(d), this.DragEndEvent = new Cmn.Event(d), this.Config = { HoldTime: 3e3 }, e = this, (new Date).getTime(), h = function (b) { return b = a.event && a.event.touches ? event.touches[0] : b, b = b || event.changedTouches[0], { x: b.pageX, y: b.pageY } }, j = b, k = {}, n = null, o = { Action: "", Selector: d.replace(/^\#|\./g, "") }, $("body").delegate(d, Cmn.UI.EventType.Mousedown, function (b) { c.UI.StopBubble(b), c.UI.StopDefault(b); var d = $(this); k = h(b), o.Action = "dragstart", clearTimeout(n), n = setTimeout(function () { o.Action = "hold", e.HoldEvent.Trigger([o]) }, e.Config.HoldTime), e.DragStartEvent.Trigger([o]) !== !1 && (d.off(Cmn.UI.EventType.Mousemove, p).on(Cmn.UI.EventType.Mousemove, p), $(a).off(Cmn.UI.EventType.Mouseup, q).on(Cmn.UI.EventType.Mouseup, q)) }), this.Tap = function (a) { 0 == arguments.length ? this.TapEvent.Trigger() : Cmn.IsType(a, "function") ? this.TapEvent.Add(a, "cmn_touch_tap") : this.TapEvent.Remove("cmn_touch_tap") }, this.Swipe = function (a, b) { 0 == arguments.length ? this.TapEvent.Trigger() : 1 == arguments.length && Cmn.IsType(a, "function") ? (j = "", this.SwipeEvent.Add(a, "cmn_touch_swipe")) : Cmn.IsType(b, "function") ? (j = Cmn.Func.FirstUppercase(a), this.SwipeEvent.Add(b, "cmn_touch_swipe")) : this.SwipeEvent.Remove("cmn_touch_swipe") }, this.Hold = function (a) { 0 == arguments.length ? this.TapEvent.Trigger() : Cmn.IsType(a, "function") ? this.HoldEvent.Add(a, "cmn_touch_hold") : this.HoldEvent.Remove("cmn_touch_hold") }, this.Drag = function (a) { 0 == arguments.length ? this.TapEvent.Trigger() : Cmn.IsType(a, "function") ? this.DragEvent.Add(a, "cmn_touch_drag") : this.DragEvent.Remove("cmn_touch_drag") }, this.DragStart = function (a) { 0 == arguments.length ? this.TapEvent.Trigger() : Cmn.IsType(a, "function") ? this.DragStartEvent.Add(a, "cmn_touch_dragstart") : this.DragStartEvent.Remove("cmn_touch_dragstart") }, this.DragEnd = function (a) { 0 == arguments.length ? this.TapEvent.Trigger() : Cmn.IsType(a, "function") ? this.DragEndEvent.Add(a, "cmn_touch_dragend") : this.DragEndEvent.Remove("cmn_touch_dragend") } }, e = {}; Cmn.Extend(Cmn.UI, { Touch: function (a) { return $(a), a ? (e[a] || (e[a] = new d(a)), e[a]) : (Cmn.DebugLog("当前dom对象不存在！"), void 0) } }) }(), Cmn.Extend(Cmn.UI, { ImageCarouselModel: { ThreeDCard: "ThreeDCard" }, ImageCarousel: function (a, c) { var d = this; return new function () { var g, h, i, j, k, e = this, f = $(a); e.Option = Cmn.Extend({ Model: d.ImageCarouselModel.ThreeDCard, Auto: !1, Speed: 460, Item: ".cmn-ui-item", Width: 0, Height: 0, IndexItem: ".cmn-ui-index", Selected: ".Selected", DefaultIndex: 0 }, c), e.GetNextIndex = function (a) { return a = a == b ? i : a, a >= g.length - 1 ? 0 : a + 1 }, e.GetPrevIndex = function (a) { return a = a == b ? i : a, 0 >= a ? g.length - 1 : a - 1 }, g = $(a).find(e.Option.Item), h = !0, i = e.Option.DefaultIndex, j = e.GetNextIndex(), k = e.GetPrevIndex(), 0 == e.Option.Width && (e.Option.Width = f.width()), 0 == e.Option.Height && (e.Option.Height = f.height()), e.Option.Model == d.ImageCarouselModel.ThreeDCard && (TweenMax.set(f, { perspective: 900, transformStyle: "preserve-3d", perspectiveOrigin: "50% 50%", width: e.Option.Width, height: e.Option.Height }), TweenMax.set(g, { zIndex: 0, z: -1 * (e.Option.Width / 2), width: e.Option.Width, height: e.Option.Height }), TweenMax.set(g.eq(i), { zIndex: 3, z: "0px" }), TweenMax.set(g.eq(j), { zIndex: 2, x: e.Option.Width / 2 }), TweenMax.set(g.eq(k), { zIndex: 2, x: -1 * (e.Option.Width / 2) })), e.Next = function () { g.width() / 2; var b = function (a, c) { var d = { zIndex: 0, x: -1 * (e.Option.Width / 2), z: -1 * (e.Option.Width / 2), onComplete: function () { a == e.GetNextIndex(j) && (k = i, i = j, j = a, c && c()) } }; a == k ? (d.zIndex = 0, d.x = 0) : a == i ? (d.zIndex = 2, d.x = -1 * (e.Option.Width / 2), d.z = d.x) : a == j ? (d.zIndex = 3, d.x = 0, d.z = 0) : (d.zIndex = 2, d.x = e.Option.Width / 2), TweenMax.to(g.eq(a), e.Option.Speed / 1e3, d), a != e.GetNextIndex(j) && b(e.GetNextIndex(a), c) }; h && (h = !1, b(k, function () { h = !0 })) }, e.Prev = function () { var a = function (b, c) { var d = { zIndex: 0, x: 0, z: -1 * (e.Option.Width / 2), onComplete: function () { b == e.GetPrevIndex(k) && (j = i, i = k, k = b, c && c()) } }; b == k ? (d.zIndex = 3, d.x = 0, d.z = 0) : b == i ? (d.zIndex = 2, d.x = e.Option.Width / 2, d.z = -1 * d.x) : b == j ? (d.zIndex = 0, d.x = 0) : (d.zIndex = 2, d.x = -1 * (e.Option.Width / 2)), TweenMax.to(g.eq(b), e.Option.Speed / 1e3, d), b != e.GetPrevIndex(k) && a(e.GetPrevIndex(b), c) }; h && (h = !1, a(j, function () { h = !0 })) } } } }) }(window);