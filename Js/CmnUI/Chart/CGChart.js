Cmn_UI_CGChart_Version = "2.0", function (a) { var c = a.Cmn; return c.UI ? (c.UI.ChartType = { Scatter: "scatter", Pie: "pie", Area: "area", Bar: "bar", Column: "column", Line: "line" }, Highcharts.setOptions({ lang: { downloadJPEG: "下载保存为JGEP", downloadPDF: "下载保存为PDF", downloadPNG: "下载保存为PNG", downloadSVG: "下载保存为SVG", printChart: "打印图表" } }), c.UI.CGChart = function (a, b, c, d, e, f) { var g = this; g.ChartsOption = $.extend({ title: { text: "" }, subtitle: { text: "" }, chart: { renderTo: a, type: c, width: $("#" + a).attr("width") || 500, height: $("#" + a).attr("height") || 300 }, yAxis: { title: { text: "" } }, tooltip: { crosshairs: !0, shared: !0 }, credits: { enabled: !1 }, series: [] }, f), g.CurChart = null, g.MappingOption = d || [], g.IsInitConplete = !1, g.CacheSeriesData = { length: 0, treatment: 0 }, g.AddSeries(b, d, e) }, c.UI.CGChart.prototype.GetFormatSeriesDataData = function (a, b, d) { var e = this; c.Object.IsType(a, "string") ? /^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, "")) ? d && d.call(this, e.FormatSeriesData($.parseJSON(a))) : CmnAjax.PostData(a, b, function (a) { a = c.Object.IsType(a, "string") ? $.parseJSON(a) : a, a = a.data ? a.data : a, d && d.call(this, e.FormatSeriesData(a)) }) : c.Object.IsType(a, "object") ? d && d.call(this, e.FormatSeriesData([a])) : c.Object.IsType(a, "array") && d && d.call(this, e.FormatSeriesData(a)) }, c.UI.CGChart.prototype.FormatSeriesData = function (a) { var b = this, d = [], e = { categories: [] }; return b.MappingOption && b.MappingOption.length && 0 != b.MappingOption.length ? $.each(b.MappingOption, function (b, c) { $.each(a, function (a, f) { var g = {}; $.each(f, function (a, b) { c["YFieldName"] == a ? g["y"] = 1 * b : c["XFieldName"] == a ? (g["name"] = b, e.categories.push(b)) : g[a] = b }), d[b] || d.push({ data: [] }), d[b].data.push(g), c.Desc && (d[b].name = c.Desc) }) }) : $.each(a, function (a, b) { if (c.Object.IsType(b, "object")) { var f = {}, g = 0; $.each(b, function (a, b) { 0 == g ? f["y"] = 1 * b : 1 == g ? (f["name"] = b, e.categories.push(b)) : f[a] = b, g++ }), d[0] || d.push({ data: [] }), d[0].data.push(f) } else d[0] || d.push({ data: [] }), d[0].data.push(b) }), e.categories.length > 0 && (b.ChartsOption.xAxis = $.extend(b.ChartsOption.xAxis, e)), d }, c.UI.CGChart.prototype.DarwCharts = function (a) { function c(a) { if (!(b.CacheSeriesData.treatment >= b.CacheSeriesData.length)) { var d = b.CacheSeriesData[b.CacheSeriesData.treatment + ""]; b.MappingOption = d.MappingOption, b.GetFormatSeriesDataData(d.DataOrItf, d.Param, function (d) { b.CacheSeriesData.treatment <= b.CacheSeriesData.length - 1 && (b.CacheSeriesData.treatment++, a && a(d), c(a)) }) } } var b = this; c(a) }, c.UI.CGChart.prototype.AddSeries = function (a, b, c) { var d = this; d.CacheSeriesData[d.CacheSeriesData.length + ""] = { DataOrItf: a, Param: c, MappingOption: b }, d.CacheSeriesData.length++, d.DarwCharts(function (a) { d.CurChart ? d.CurChart.addSeries(a[0], !0) : (a.length > 0 && (d.ChartsOption.series = a), d.CurChart = new Highcharts.Chart(d.ChartsOption)) }) }, void 0) : (alert("请引用CmnUI.js"), void 0) }(window);